$.fn.contactMap=function(){var o=L.icon({iconUrl:"../presentation/shared-ro/maps/images/nlww-marker-icon.png",shadowUrl:"../presentation/shared-ro/maps/images/marker-shadow.png",iconSize:[17,29],shadowSize:[17,29],shadowAnchor:[8,24]}),t=L.icon({iconUrl:"../presentation/shared-ro/maps/images/nlww-marker-icon-active.png",shadowUrl:"../presentation/shared-ro/maps/images/marker-shadow.png",iconSize:[32,53],shadowSize:[32,53],iconAnchor:[17,37],shadowAnchor:[10,37]});return this.each(function(){function n(){a(),r(),p.find(".collapsiblePanels").createCollapsePanels(),$(window).on("resize",function(){a(),e(),i()}),e()}function a(){k="screen-xs"===Core.viewport||"screen-xxs"===Core.viewport?"mobile":"desktop"}function i(){var o=m.outerHeight(),t=g.outerHeight(),n=o+120;"mobile"===k&&(n=o+200),t<n&&$(g).css({height:n+"px"}),f.invalidateSize()}function e(){if("mobile"===k){var o=m.outerHeight();f.fitBounds(v,{paddingBottomRight:[60,o+20],paddingTopLeft:[20,35]})}else f.fitBounds(v,{paddingBottomRight:[500,70],paddingTopLeft:[70,70]});f.invalidateSize()}function r(){h.each(function(o){$location=$(this);var t="location"+o,n=[],a=$location.attr("data-geolocation").split(","),i=$location.find("dl").html(),e=$location.find("a").attr("href"),r=$location.find("a").text(),l=$location.find("a").attr("title"),c=$location.find("p").html();n.push(a[0],a[1],$location.find("h3").text(),t,i,e,r,l,c),u.push(n),$location.attr("data-id",t)}),l(),c()}function l(){f=new L.map(g[0],{zoomControl:!0,zoom:12,tap:!0}).setView(new L.latLng(51.3,.7),9);var o=p.attr("data-layerurl")||"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",t=p.attr("data-attribution"),n=new L.TileLayer(o,{attribution:t,detectRetina:"true"}).addTo(f);f.addLayer(n),v=L.latLngBounds(u),f.doubleClickZoom.enable(),f.scrollWheelZoom.enable()}function c(){for(var n=0;n<u.length;n++)w[n]=new L.marker([u[n][0],u[n][1]],{icon:o,title:u[n][2],locationId:u[n][3],address:u[n][4],locationUrl:u[n][5],locationContactInfo:u[n][6],locationLinkTitle:u[n][7],locationMessage:u[n][8]}),w[n].addTo(f),0===n&&(d(w[n].options),w[0].setIcon(t)),w[n].on("click",s)}function s(n){for(var a=0;a<w.length;a++)w[a].setIcon(o);d(n.target.options),n.target.setIcon(t)}function d(o){m.html(""),void 0!==o.locationMessage&&$("<p/>",{text:o.locationMessage}).appendTo(m),void 0!==o.title&&$("<h2/>",{text:o.title}).appendTo(m),void 0!==o.address&&$("<dl/>",{html:o.address}).appendTo(m),void 0!==o.locationUrl&&$("<a/>",{href:o.locationUrl,text:o.locationContactInfo,title:o.locationLinkTitle}).appendTo(m),i()}var p=$(this),h=p.find(".location"),f="",g=p.find(".locationMap"),m=p.find(".locationData"),u=[],w=[],v="",k="desktop";n()})},$(".mapsComponent").contactMap();