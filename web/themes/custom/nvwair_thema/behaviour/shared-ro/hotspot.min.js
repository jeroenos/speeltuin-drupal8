$.fn.createHotspot=function(){var t={position:"center",displayType:"desktop",minToolTipSpace:20},i=$.extend({},t);return this.each(function(){function t(){l.settings=i,l.imageMap=l.find(".hotspotmap"),l.spotData=l.find(".hotspotinfo"),l.hotspots=l.imageMap.find("li"),l.anchors=l.imageMap.find("a"),o(),s(),a(),e(),n()}function o(){l.spotData.find("div").each(function(t,i){var o=$(this).find(".thumb").clone();o.length>0&&l.imageMap.find('li[data-id="'+$(this).attr("id")+'"] a').append(o).addClass("hasThumb")})}function e(){l.each(function(){var t=$(this).find(".hotspotimage"),i=$(this).find("p").first().hasClass("copyright"),o=$(this).find("p").first().hasClass("cite");if(o){var e=$(this).find("p.cite");e.insertAfter(t)}else if(i){var s=$(this).find("p.copyright");s.insertAfter(t)}})}function s(){l.settings.displayType=window.getComputedStyle(document.body,":after").getPropertyValue("content")||"desktop"}function n(){l.anchors.on("click",function(t){t.preventDefault();var i=$(this).parent("li"),o=i.attr("data-id");'"mobile"'===l.settings.displayType||'"tablet"'===l.settings.displayType?$("html, body").animate({scrollTop:$("#"+o).offset().top-30},"slow"):$(this).hasClass("open")?($(this).removeClass("open"),i.find(".tooltip").hide()):(d(),l.anchors.removeClass("open"),$(this).addClass("open"),0===i.find(".tooltip").length?p(o):i.find(".tooltip").show())}),$(window).on("resize orientationchange",function(){s(),f(),a()}),l.find(".scrollToTop").click(function(){$("html, body").animate({scrollTop:0},"slow")})}function a(){l.spotData.find("img").not(".thumb").each(function(){$img=$(this),$imgClass=$(this).attr("class"),'"mobile"'===l.settings.displayType||"bottom"===$imgClass?$img.appendTo($img.parent("div")):$img.prependTo($img.parent("div"))})}function p(t){var i=l.imageMap.find('li[data-id="'+t+'"]'),o=i.find("a"),e=l.spotData.find("#"+t),s=(o.outerWidth(),o.outerHeight()),n=$("<div/>",{"class":"tooltip",tabindex:"0",html:e.html()}).appendTo(i);n.find("img").each(function(){var t=$(this).attr("class");"thumb"!==t&&(n.addClass("image"+t),"bottom"!==t&&($img=$(this),$(this).remove(),$img.prependTo(n).addClass("moved")))});var a=n.innerWidth();n.css({left:-a/2,bottom:s/2+15}),n.offset().left-l.offset().left<l.settings.minToolTipSpace&&(n.addClass("left"),n.css({left:-20}));var p=l.innerWidth()-(n.offset().left-l.offset().left+n.innerWidth());if(p<l.settings.minToolTipSpace)if(n.hasClass("left")){var d=n.outerWidth()-(p+n.outerWidth()-l.settings.minToolTipSpace);n.outerWidth(n.outerWidth()-d)}else{n.addClass("right"),n.css({left:-a+20});var f=n.offset().left-l.offset().left-l.settings.minToolTipSpace;f<0&&(n.outerWidth(n.outerWidth()+f),n.css({left:+n.position().left-f}))}n.offset().top-l.offset().top<l.settings.minToolTipSpace&&(n.addClass("bottom"),n.css({bottom:"auto",top:s/2+15}))}function d(){l.imageMap.find(".open").removeClass("open").parent("li").find(".tooltip").hide()}function f(){d(),l.imageMap.find(".tooltip").remove()}var l=$(this);$(window).width();t()})},$(".hotspotContainer").createHotspot();